{% load custom_filters %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Membership Detail Report</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

    <!-- üîπ Back Button & Logout -->
    <div class="container mt-2">
        <div class="d-flex justify-content-between align-items-center">
            <!-- ‚úÖ Bot√≥n din√°mico: Redirige seg√∫n el origen -->
            {% if request.GET.origin == "cap_yearly" %}
                <a href="{% url 'cap_yearly' %}" class="fw-bold text-primary">‚Üê Back to Report</a>
            {% else %}
                <a href="{% url 'cap_pivot' %}" class="fw-bold text-success">‚Üê Back to Report</a>
            {% endif %}

            <!-- ‚úÖ Bot√≥n de Logout -->
            <form method="post" action="{% url 'logout' %}" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-outline-danger btn-sm">Logout</button>
            </form>
        </div>
    </div>

    <!-- üîπ Report Title -->
    <div class="container mt-2 mb-1">
        <div class="p-3 rounded text-white bg-primary shadow-sm text-center">
            <h1 class="fw-bold text-uppercase fs-5 m-0">
                Membership Detail - {{ plan }} ({{ capmo }})
            </h1>
        </div>
    </div>

    <!-- üîπ Export Buttons -->
    <div class="container d-flex justify-content-end gap-2 mb-1">
        <a href="{% url 'export_detail_to_csv' plan capmo %}" class="btn btn-outline-secondary btn-sm fw-bold">üìÑ Export to CSV</a>
        <a href="{% url 'export_detail_to_pdf' plan capmo %}" class="btn btn-outline-danger btn-sm fw-bold">üìÑ Export to PDF</a>
    </div>

    <!-- üîπ Report Content -->
    <div class="container bg-white p-3 rounded shadow-sm mt-2">
        {% if data %}
            <div class="table-responsive">
                <table class="table table-sm table-hover text-center align-middle">
                    <thead class="bg-primary text-white">
                        <tr>
                            <th class="text-start px-2">Center</th>
                            <th class="px-2">Plan</th>
                            <th class="px-2">LOB</th>
                            <th class="px-2">Membership</th>
                            <th class="px-2">ID</th>
                            <th class="px-2">HIC Number</th>
                            <th class="px-2">Medicaid Number</th>
                            <th class="px-2">Member Name</th>
                            <th class="px-2">DOB</th>
                            <th class="px-2">Age</th>
                            <th class="px-2">Sex</th>
                            <th class="px-2">Address</th>
                            <th class="px-2">City</th>
                            <th class="px-2">State</th>
                            <th class="px-2">ZIP</th>
                            <th class="px-2">County</th>
                            <th class="px-2">Phone Number</th>
                            <th class="px-2">Capmo</th>
                            <th class="px-2">PCP Name</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in data %}
                            <tr>
                                <td class="text-start px-2">{{ row.center }}</td>
                                <td>{{ row.plan }}</td>
                                <td>{{ row.lob }}</td>
                                <td>{{ row.mbshp }}</td>
                                <td>{{ row.id }}</td>
                                <td>{{ row.hic_num }}</td>
                                <td>{{ row.mcaid_num }}</td>
                                <td>{{ row.membname }}</td>
                                <td>{{ row.dob }}</td>
                                <td>{{ row.age }}</td>
                                <td>{{ row.sex }}</td>
                                <td>{{ row.address }}</td>
                                <td>{{ row.city }}</td>
                                <td>{{ row.st }}</td>
                                <td>{{ row.zip }}</td>
                                <td>{{ row.county }}</td>
                                <td>{{ row.phonenumber }}</td>
                                <td>{{ row.capmo }}</td>
                                <td>{{ row.pcpname }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            <div class="alert alert-info text-center" role="alert">
                No data available for this report.
            </div>
        {% endif %}
    </div>

    <!-- üîπ Custom Styles -->
    <style>
        .table th {
            background: #0d6efd !important;
            color: white;
            font-weight: bold;
            font-size: 0.85rem;
        }
        .table td {
            font-size: 0.8rem;
            padding: 6px;
        }
        /* Hover Effect */
        .table-hover tbody tr:hover {
            background-color: rgba(13, 110, 253, 0.15) !important;
            transition: background 0.2s ease-in-out;
        }
    </style>

</body>
</html>
